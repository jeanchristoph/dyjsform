export default class ValidatorService{static validateMaxCount(json){const valueOccurrences={};const addOccurrence=(entityName,label,value,maxCount,rowIndex)=>{const key=`${entityName}:${value}`;if(!valueOccurrences[key]){valueOccurrences[key]={entityName:entityName,label:label,value:value,maxCount:maxCount,occurrences:[]}}valueOccurrences[key].occurrences.push({rowIndex:rowIndex,name:entityName})};json.forEach(((row,rowIndex)=>{row.forEach((entity=>{if(entity.htmlElement==="select"&&Array.isArray(entity.options)){const selectedOption=entity.options.find((opt=>opt.value===entity.value));if(selectedOption&&selectedOption.maxCount!==null){addOccurrence(entity.name,selectedOption.name,selectedOption.value,selectedOption.maxCount,rowIndex)}}else if(entity.htmlElement==="input"&&entity.maxCount!==null){addOccurrence(entity.name,entity.label||entity.name,entity.value,entity.maxCount,rowIndex)}}))}));const errors=Object.values(valueOccurrences).reduce(((acc,data)=>{const{maxCount:maxCount,occurrences:occurrences,entityName:entityName,label:label,value:value}=data;if(occurrences.length>maxCount){acc.push({entityName:entityName,label:label,value:value,maxCount:maxCount,occurrences:occurrences,message:`"${label}" ne peut pas être renseignée plus de ${maxCount} fois.`})}return acc}),[]);return{valid:errors.length===0,errors:errors}}}